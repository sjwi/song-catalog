<div class="alert alert-light py-0 px-0 add-songs-alert text-center rounded-top" role="alert">
  <div class="alert-opac px-3 rounded-top">
    <div class="col my-0 pl-0 pt-2 text-center" id="hideAddAlert">
      <i class="fa fa-angle-down" aria-hidden="true"></i>
      <i class="fa fa-angle-up collapse" aria-hidden="true"></i>
    </div>
    <div class="my-1">Add <span id="addSongCount">1</span> <span id="addSongWord">song</span> to a set. 
      (<a href="javascript:void(0)" onclick="resetSelectedSongs()">reset</a>)
    </div>
    <div class="row">
      <div class="col-12 px-1 text-center mt-0">
      </div>
      <div class="col-12 px-3 text-center my-1">
        <button type="button" class="btn btn-info w-100 mt-2 mb-0 px-5 mw-400" onclick="addSelectedSongsToSet()">Add</button>
      </div>
    </div>
  </div>
</div>
<script>
  let cachedCheckedSongIds = new Set();
  $(document).on('click','#hideAddAlert',function(){
    if ($('.alert.add-songs-alert').hasClass('slide-down')) {
      slideAlertUp();
    } else {
      slideAlertDown();
    }
  });
  $(document).on('click', '.song-select-checkbox-container',function(e){
    var checkbox = $(this).children('input[type="checkbox"]');
    checkbox.prop('checked', !checkbox.prop('checked')).change();
  });
  $(document).on('change', 'input.song-select:checkbox', function (e) {
    if ($(this).is(':checked')) {
      cachedCheckedSongIds.add($(this).data('target'));
    } else {
      cachedCheckedSongIds.delete($(this).data('target'));
    }
    if (cachedCheckedSongIds.size > 0) {
      showAddSongsAlert();
    } else {
      hideAddSongsAlert();
    }
  });
  function slideAlertUp(){
    $('.alert.add-songs-alert').removeClass('slide-down');
    $('#hideAddAlert .fa-angle-up').hide();
    $('#hideAddAlert .fa-angle-down').show();
    $('#songListTable').css('padding-bottom','150px');
  }
  function slideAlertDown(){
    $('.alert.add-songs-alert').addClass('slide-down');
    $('#hideAddAlert .fa-angle-up').show();
    $('#hideAddAlert .fa-angle-down').hide();
    $('#songListTable').css('padding-bottom','25px');
  }
  function showAddSongsAlert(){
    if (cachedCheckedSongIds.size == 1){
      $('#addSongWord').html("song")
    } else {
      $('#addSongWord').html("songs")
    }
    $('#addSongCount').html(cachedCheckedSongIds.size)
    $('.alert.add-songs-alert').addClass('display');
    $('#songListTable').css('padding-bottom','150px');
    $('.action-btn').css('pointer-events','none')
  }
  function hideAddSongsAlert(){
    $('#songListTable').css('padding-bottom','0px');
    $('.alert.add-songs-alert').removeClass('display slide-down');
    $('#hideAddAlert .fa-angle-up').hide();
    $('#hideAddAlert .fa-angle-down').show();
    $('.action-btn').css('pointer-events','auto')
  }
  function resetSelectedSongs(){
    $('input.song-select:checkbox').prop('checked', false);
    cachedCheckedSongIds.clear();
    hideAddSongsAlert();
  }
</script>